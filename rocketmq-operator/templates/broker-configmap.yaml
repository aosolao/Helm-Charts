---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Values.ConfigMap.name }}
  namespace: {{ .Release.Namespace }}
data:
  # BROKER_MEM sets the broker JVM, if set to "" then Xms = Xmx = max(min(1/2 ram, 1024MB), min(1/4 ram, 8GB))
  BROKER_MEM: "{{ .Values.ConfigMap.BROKER_MEM }}"
  broker-common.conf: |
    # brokerClusterName, brokerName, brokerId are automatically generated by the operator and do not set it manually!!!
{{- with .Values.ConfigMap.broker_conf }}
{{ toYaml . | indent 4 }}
{{- end }}
    # config plain_acl.yml start
    globalWhiteRemoteAddresses:
{{- with .Values.ConfigMap.plain_acl_yml.globalWhiteRemoteAddresses }}
{{ toYaml . | indent 6 }}
{{- end }}
    accounts:
{{- with .Values.ConfigMap.plain_acl_yml.accounts }}
{{ toYaml . | indent 6 }}
{{- end }}
    # config plain_acl.yml end
    # config tools_yml start
{{- with .Values.ConfigMap.tools_yml }}
{{ toYaml . | indent 4 }}
{{- end }}
    # config tools_yml end
